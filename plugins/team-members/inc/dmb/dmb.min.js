/**
 * Team Members Admin JS (minified)
 */

!function(h){h(document).ready(function(){var a;a=jQuery.fn.clone,jQuery.fn.clone=function(){for(var e=a.apply(this,arguments),t=this.find("textarea").add(this.filter("textarea")),i=e.find("textarea").add(e.filter("textarea")),m=this.find("select").add(this.filter("select")),n=e.find("select").add(e.filter("select")),_=0,s=t.length;_<s;++_)h(i[_]).val(h(t[_]).val());for(_=0,s=m.length;_<s;++_)n[_].selectedIndex=m[_].selectedIndex;return e};var t,m,n,_,s,d="team-members",i=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");function o(e){return isNaN(e)?"00":i[(e-e%16)/16]+i[e%16]}function l(e){var t=e.closest(".dmb_main"),i=t.find(".dmb_firstname_of_member").val()||"",m=t.find(".dmb_lastname_of_member").val()||"",n=t.find(".dmb_job_of_member").val()||"";description=h("#acf-fallback-bio").length?h.trim(t.find(".dmb_description_of_member_fb").text())||"":h.trim(t.find(".dmb_description_of_member").html())||"";var _=t.find(".dmb_scl_type1_of_member").val()||"",s=t.find(".dmb_scl_title1_of_member").val()||"",a=t.find(".dmb_scl_url1_of_member").val()||"",l=t.find(".dmb_scl_type2_of_member").val()||"",d=t.find(".dmb_scl_title2_of_member").val()||"",o=t.find(".dmb_scl_url2_of_member").val()||"",r=t.find(".dmb_scl_type3_of_member").val()||"",c=t.find(".dmb_scl_title3_of_member").val()||"",b=t.find(".dmb_scl_url3_of_member").val()||"",f=t.find(".dmb_img_data_url").attr("data-img")||"",e=t.find(".dmb_photo_url_of_member").val()||"";t.find(".dmb_data_dump").val(i+"]--["+m+"]--["+n+"]--["+h("<div/>").html(description).text()+"]--["+_+"]--["+s+"]--["+a+"]--["+l+"]--["+d+"]--["+o+"]--["+r+"]--["+c+"]--["+b+"]--["+f+"]--["+e)}function r(){0<h(".dmb_main").not(".dmb_empty_row").length?h(".dmb_no_row_notice").hide():h(".dmb_no_row_notice").show()}function c(e){var t=document.createElement("div"),i=document.createTextNode(e);return t.appendChild(i),e}function b(e,t){t=t||!1;var i=(e=e).closest(".dmb_main").find(".dmb_lastname_of_member").val()||"";firstname=e.val()||"",handleTitle=e.closest(".dmb_main").find(".dmb_handle_title"),cloneCopyText="",cloneCopyText=t?" copy":"",title=firstname+" "+i+cloneCopyText,""!=e.val()?handleTitle.html(c(title)):handleTitle.html(objectL10n.untitled+cloneCopyText)}h(".dmb_color_picker").each(function(e,t){h(this).wpColorPicker()}),h("body").on("keyup",".dmb_field",function(e){l(h(this))}),h("body").on("change",".dmb_scl_type_select",function(e){l(h(this))}),h("body").on("change",".dmb_img_data_url",function(e){l(h(this))}),h(".dmb_img_data_url").each(function(e,t){var i=h(this).attr("data-img");""!=i&&h("<a class='dmb_remove_img_btn dmb_button dmb_button_large dmb_button_compact' href='#'><span class='dashicons dashicons-trash'></span></a><img src='"+i+"' class='dmb_img'/>").insertAfter(h(this).parent().find(".dmb_upload_img_btn"))}),h(".dmb_main").not(".dmb_empty_row").each(function(e,t){h(this).find(".dmb_description_of_member").each(function(e,t){""==h.trim(h(this).text())?h(this).hide():h(this).show(),h(this).html(h(this).text())}),l(h(this).find(".dmb_field").first())}),r(),h("body").on("click",".dmb_remove_img_btn",function(e){return h(this).parent().find(".dmb_img").remove(),h(this).parent().find(".dmb_img_data_url").attr("data-img","").trigger("change"),h(this).remove(),!1}),h(".dmb_upload_img_btn").click(function(e){e.preventDefault();var t=h(this),i=wp.media({title:"Insert image",library:{type:"image"},button:{text:"Use this image"},multiple:!1}).on("select",function(){var e=i.state().get("selection").first().toJSON();t.siblings("img, .dmb_remove_img_btn, .dashicons-trash").remove(),h("<a class='dmb_remove_img_btn dmb_button dmb_button_large dmb_button_compact' href='#'><span class='dashicons dashicons-trash'></span></a><img src='"+e.url+"' class='dmb_img'/>").insertAfter(t),t.siblings(".dmb_img_data_url").attr("data-img",e.url).trigger("change")}).open()}),h(".dmb_add_row").on("click",function(){var e=h(".dmb_empty_row").clone(!0);return e.removeClass("dmb_empty_row").addClass("dmb_main").show(),e.insertBefore(h(".dmb_empty_row")),e.find(".dmb_firstname_of_member").focus(),e.find(".dmb_color_picker_ready").removeClass(".dmb_color_picker_ready").addClass(".dmb_color_picker").wpColorPicker().css({padding:"3px"}),e.find(".dmb_handle_title").html(objectL10n.untitled),e.find(".dmb_description_of_member").hide(),r(),!1}),h(".dmb_remove_row_btn").click(function(e){return h(this).closest(".dmb_main").remove(),r(),!1}),h(".dmb_handle").click(function(e){return h(this).siblings(".dmb_inner").slideToggle(50),h(this).hasClass("closed")?h(this).removeClass("closed"):h(this).addClass("closed"),!1}),h(".dmb_collapse_rows").click(function(e){return h(".dmb_handle").each(function(e,t){h(this).closest(".dmb_empty_row").length||h(this).hasClass("closed")||(h(this).siblings(".dmb_inner").slideToggle(50),h(this).addClass("closed"))}),!1}),h(".dmb_expand_rows").click(function(e){return h(".dmb_handle").each(function(e,t){h(this).hasClass("closed")&&(h(this).siblings(".dmb_inner").slideToggle(50),h(this).removeClass("closed"))}),!1}),h(".dmb_move_row_down").click(function(e){return h(this).closest(".dmb_main").next().hasClass("dmb_main")&&(h(this).closest(".dmb_main").clone(!0).insertAfter(h(this).closest(".dmb_main").next()),h(this).closest(".dmb_main").remove()),!1}),h(".dmb_move_row_up").click(function(e){return h(this).closest(".dmb_main").prev().hasClass("dmb_main")&&(h(this).closest(".dmb_main").clone(!0).insertBefore(h(this).closest(".dmb_main").prev()),h(this).closest(".dmb_main").remove()),!1}),h(".dmb_clone_row").click(function(e){var t=h(this).closest(".dmb_main").clone(!0);return t.insertAfter(h(this).closest(".dmb_main")),t.find(".dmb_handle_title").html(t.find(".dmb_firstname_of_member").val()+" ("+objectL10n.copy+")"),t.find(".dmb_firstname_of_member").focus(),b(t.find(".dmb_firstname_of_member"),!0),r(),!1}),h(".dmb_main").not(".dmb_empty_row").each(function(e,t){var i,m,n;""!=h(this).find(".dmb_firstname_of_member").val()&&(i=h(this).find(".dmb_handle_title"),m=h(this).find(".dmb_firstname_of_member").val(),n=h(this).find(".dmb_lastname_of_member").val(),i.html(h.parseHTML(m+" "+n)))}),h("body").on("keyup",".dmb_firstname_of_member",function(e){b(h(this))}),h("body").on("keyup",".dmb_lastname_of_member",function(e){firstnameField=h(this).closest(".dmb_main").find(".dmb_firstname_of_member"),b(firstnameField)}),h(".dmb_show_preview_team").click(function(){var s={},a={},l="";s.columns=h("select[name='team_columns'] option:selected").val(),s.bio_alignment=h("select[name='team_bio_align'] option:selected").val(),s.piclink_beh=h("select[name='team_piclink_beh'] option:selected").val(),"new"==s.piclink_beh?a.plb='target="_blank"':a.plb="",s.color=function(e){if(e)return"#"+o((e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))[1])+o(e[2])+o(e[3])}(h(".dmb_color_of_team").find(".wp-color-result").css("backgroundColor"))||"#8dba09",a.memberCount=h(".dmb_main").not(".dmb_empty_row").length,l+='<div class="tmm" style="margin-top: 100px;">',l+='<div class="tmm_'+s.columns+'_columns tmm_wrap tmm_plugin_f">',h(".dmb_main").not(".dmb_empty_row").each(function(e,t){var i={};i.firstname=c(h(this).find(".dmb_firstname_of_member").val()),i.lastname=c(h(this).find(".dmb_lastname_of_member").val()),i.job=c(h(this).find(".dmb_job_of_member").val()),h("#acf-fallback-bio").length?i.bio=h.trim(h(this).find(".dmb_description_of_member_fb").text())||"":i.bio=h.trim(h(this).find(".dmb_description_of_member").html())||"",i.scl_type1=h(this).find(".dmb_scl_type1_of_member").find(":selected").val(),i.scl_title1=c(h(this).find(".dmb_scl_title1_of_member").val()),i.scl_url1=c(h(this).find(".dmb_scl_url1_of_member").val()),i.scl_type2=h(this).find(".dmb_scl_type2_of_member").find(":selected").val(),i.scl_title2=c(h(this).find(".dmb_scl_title2_of_member").val()),i.scl_url2=c(h(this).find(".dmb_scl_url2_of_member").val()),i.scl_type3=h(this).find(".dmb_scl_type3_of_member").find(":selected").val(),i.scl_title3=c(h(this).find(".dmb_scl_title3_of_member").val()),i.scl_url3=c(h(this).find(".dmb_scl_url3_of_member").val()),i.photoUrl=h(this).find(".dmb_img").attr("src"),i.photoLinkUrl=c(h(this).find(".dmb_photo_url_of_member").val()),e%2==0&&(l+='<span class="tmm_two_containers_tablet"></span>'),e%s.columns==0&&(0<e&&(l+='</div><span class="tmm_columns_containers_desktop"></span>'),l+='<div class="tmm_container">'),l+='<div class="tmm_member" style="border-top:'+s.color+' solid 5px;">',i.photoLinkUrl&&(l+="<a "+s.piclink_beh+' href="'+i.photoLinkUrl+'" title="'+i.firstname+" "+i.lastname+'">'),i.photoUrl&&(l+='<div class="tmm_photo tmm_pic_'+e+'" style="background: url('+i.photoUrl+'); margin-left: auto; margin-right:auto; background-size:cover !important;"></div>'),i.photoLinkUrl&&(l+="</a>"),l+='<div class="tmm_textblock">',l+='<div class="tmm_names">',i.firstname&&(l+='<span class="tmm_fname">'+i.firstname+"</span> "),i.lastname&&(l+='<span class="tmm_lname">'+i.lastname+"</span>"),l+="</div>",i.job&&(l+='<div class="tmm_job">'+i.job+"</div>"),i.bio&&(l+='<div class="tmm_desc" style="text-align:'+s.bio_alignment+'">'+i.bio+"</div>"),l+='<div class="tmm_scblock">';for(var m,n,_=1;_<=3;_++)"nada"!=i["scl_type"+_]&&(m=i["scl_url"+_]||"",n=i["scl_title"+e]?i["scl_title"+_]:"","email"==i["scl_type"+_]?l+='<a class="tmm_sociallink" href="mailto:'+m+'" title="'+n+'"><img alt="'+n+'" src="../wp-content/plugins/'+d+"/inc/img/links/"+i["scl_type"+_]+'.png"/></a>':l+='<a target="_blank" class="tmm_sociallink" href="'+m+'" title="'+n+'"><img alt="'+n+'" src="../wp-content/plugins/'+d+"/inc/img/links/"+i["scl_type"+_]+'.png"/></a>');l+="</div>",l+="</div>",l+="</div>",e==a.memberCount-1&&(l+='<div style="clear:both;"></div>')}),l+="</div>",l+="</div>",l+="</div>",l+='<div style="clear:both;"></div>',l+='<div class="dmb_accuracy_preview_notice">'+objectL10n.previewAccuracy+"</div>",0==a.memberCount?h("#dmb_preview_team").append('<div class="dmb_no_row_preview_notice">'+objectL10n.noMemberNotice+"</div>"):h("#dmb_preview_team").append(l),h("#dmb_preview_team").fadeIn(100)}),h(".dmb_preview_team_close").click(function(){h("#dmb_preview_team .tmm, .dmb_accuracy_preview_notice, .dmb_no_row_preview_notice").remove(),h("#dmb_preview_team").fadeOut(100)}),h("#acf-fallback-bio").length||(t="",h(".dmb_edit_description_of_member").click(function(){var e=(t=h(this).parent().find(".dmb_description_of_member")).text();h("#wp-dmb_editor-wrap").hasClass("tmce-active")?tinymce.activeEditor.setContent(e):h("#dmb_editor").val(h.trim(e)),h("#dmb_unique_editor").fadeIn(100),null!==tinyMCE.activeEditor&&tinyMCE.activeEditor.focus()})),h("#acf-fallback-bio").length||h(".dmb_ue_update").click(function(){var e;return(e=h("#wp-dmb_editor-wrap").hasClass("tmce-active")?tinyMCE.activeEditor.getContent():h("#dmb_editor").val())?t.show():t.hide(),t.text(e),h("#dmb_unique_editor").fadeOut(100),null!==tinymce.activeEditor&&tinymce.activeEditor.setContent(""),l(t),!1}),h("#acf-fallback-bio").length||h(".dmb_ue_cancel").click(function(){h("#dmb_unique_editor").fadeOut(100)}),h("body").on("paste keyup","#acf-fallback-bio",(m=function(){h(this).siblings(".dmb_description_of_member_fb").text(h(this).val()),l(h(this))},n=600,function(){var e=this,t=arguments,i=_&&!s;clearTimeout(s),s=setTimeout(function(){s=null,_||m.apply(e,t)},n),i&&m.apply(e,t)}))})}(jQuery);